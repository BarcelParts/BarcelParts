{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ConnectionPoolMetrics = void 0;\n/** @internal */\n\nclass ConnectionPoolMetrics {\n  constructor() {\n    this.txnConnections = 0;\n    this.cursorConnections = 0;\n    this.otherConnections = 0;\n  }\n  /**\n   * Mark a connection as pinned for a specific operation.\n   */\n\n\n  markPinned(pinType) {\n    if (pinType === ConnectionPoolMetrics.TXN) {\n      this.txnConnections += 1;\n    } else if (pinType === ConnectionPoolMetrics.CURSOR) {\n      this.cursorConnections += 1;\n    } else {\n      this.otherConnections += 1;\n    }\n  }\n  /**\n   * Unmark a connection as pinned for an operation.\n   */\n\n\n  markUnpinned(pinType) {\n    if (pinType === ConnectionPoolMetrics.TXN) {\n      this.txnConnections -= 1;\n    } else if (pinType === ConnectionPoolMetrics.CURSOR) {\n      this.cursorConnections -= 1;\n    } else {\n      this.otherConnections -= 1;\n    }\n  }\n  /**\n   * Return information about the cmap metrics as a string.\n   */\n\n\n  info(maxPoolSize) {\n    return 'Timed out while checking out a connection from connection pool: ' + `maxPoolSize: ${maxPoolSize}, ` + `connections in use by cursors: ${this.cursorConnections}, ` + `connections in use by transactions: ${this.txnConnections}, ` + `connections in use by other operations: ${this.otherConnections}`;\n  }\n  /**\n   * Reset the metrics to the initial values.\n   */\n\n\n  reset() {\n    this.txnConnections = 0;\n    this.cursorConnections = 0;\n    this.otherConnections = 0;\n  }\n\n}\n\nexports.ConnectionPoolMetrics = ConnectionPoolMetrics;\nConnectionPoolMetrics.TXN = 'txn';\nConnectionPoolMetrics.CURSOR = 'cursor';\nConnectionPoolMetrics.OTHER = 'other';","map":{"version":3,"mappings":";;;;;;AAAA;;AACA,MAAaA,qBAAb,CAAkC;AAAlCC;AAKE,0BAAiB,CAAjB;AACA,6BAAoB,CAApB;AACA,4BAAmB,CAAnB;AAiDD;AA/CC;;;;;AAGAC,YAAU,CAACC,OAAD,EAAgB;AACxB,QAAIA,OAAO,KAAKH,qBAAqB,CAACI,GAAtC,EAA2C;AACzC,WAAKC,cAAL,IAAuB,CAAvB;AACD,KAFD,MAEO,IAAIF,OAAO,KAAKH,qBAAqB,CAACM,MAAtC,EAA8C;AACnD,WAAKC,iBAAL,IAA0B,CAA1B;AACD,KAFM,MAEA;AACL,WAAKC,gBAAL,IAAyB,CAAzB;AACD;AACF;AAED;;;;;AAGAC,cAAY,CAACN,OAAD,EAAgB;AAC1B,QAAIA,OAAO,KAAKH,qBAAqB,CAACI,GAAtC,EAA2C;AACzC,WAAKC,cAAL,IAAuB,CAAvB;AACD,KAFD,MAEO,IAAIF,OAAO,KAAKH,qBAAqB,CAACM,MAAtC,EAA8C;AACnD,WAAKC,iBAAL,IAA0B,CAA1B;AACD,KAFM,MAEA;AACL,WAAKC,gBAAL,IAAyB,CAAzB;AACD;AACF;AAED;;;;;AAGAE,MAAI,CAACC,WAAD,EAAoB;AACtB,WACE,qEACA,gBAAgBA,WAAW,IAD3B,GAEA,kCAAkC,KAAKJ,iBAAiB,IAFxD,GAGA,uCAAuC,KAAKF,cAAc,IAH1D,GAIA,2CAA2C,KAAKG,gBAAgB,EALlE;AAOD;AAED;;;;;AAGAI,OAAK;AACH,SAAKP,cAAL,GAAsB,CAAtB;AACA,SAAKE,iBAAL,GAAyB,CAAzB;AACA,SAAKC,gBAAL,GAAwB,CAAxB;AACD;;AAvD+B;;AAAlCK;AACkBb,4BAAM,KAAN;AACAA,+BAAS,QAAT;AACAA,8BAAQ,OAAR","names":["ConnectionPoolMetrics","constructor","markPinned","pinType","TXN","txnConnections","CURSOR","cursorConnections","otherConnections","markUnpinned","info","maxPoolSize","reset","exports"],"sources":["D:\\Barcelparts\\node_modules\\mongodb\\src\\cmap\\metrics.ts"],"sourcesContent":["/** @internal */\nexport class ConnectionPoolMetrics {\n  static readonly TXN = 'txn' as const;\n  static readonly CURSOR = 'cursor' as const;\n  static readonly OTHER = 'other' as const;\n\n  txnConnections = 0;\n  cursorConnections = 0;\n  otherConnections = 0;\n\n  /**\n   * Mark a connection as pinned for a specific operation.\n   */\n  markPinned(pinType: string): void {\n    if (pinType === ConnectionPoolMetrics.TXN) {\n      this.txnConnections += 1;\n    } else if (pinType === ConnectionPoolMetrics.CURSOR) {\n      this.cursorConnections += 1;\n    } else {\n      this.otherConnections += 1;\n    }\n  }\n\n  /**\n   * Unmark a connection as pinned for an operation.\n   */\n  markUnpinned(pinType: string): void {\n    if (pinType === ConnectionPoolMetrics.TXN) {\n      this.txnConnections -= 1;\n    } else if (pinType === ConnectionPoolMetrics.CURSOR) {\n      this.cursorConnections -= 1;\n    } else {\n      this.otherConnections -= 1;\n    }\n  }\n\n  /**\n   * Return information about the cmap metrics as a string.\n   */\n  info(maxPoolSize: number): string {\n    return (\n      'Timed out while checking out a connection from connection pool: ' +\n      `maxPoolSize: ${maxPoolSize}, ` +\n      `connections in use by cursors: ${this.cursorConnections}, ` +\n      `connections in use by transactions: ${this.txnConnections}, ` +\n      `connections in use by other operations: ${this.otherConnections}`\n    );\n  }\n\n  /**\n   * Reset the metrics to the initial values.\n   */\n  reset(): void {\n    this.txnConnections = 0;\n    this.cursorConnections = 0;\n    this.otherConnections = 0;\n  }\n}\n"]},"metadata":{},"sourceType":"script"}