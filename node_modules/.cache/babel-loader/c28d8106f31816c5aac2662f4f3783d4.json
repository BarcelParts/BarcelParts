{"ast":null,"code":"import Barcelparts from './Barcelparts.js';\nimport http from \"../http-common\"; //Function that will verify if the user is authenticated\n\nexport async function IsAuthenticated() {\n  // Checks if there is a cookie with google auth token\n  if (getCookie() != undefined) {\n    //Gets the value of the cookie\n    let token = getCookie(); // Queries the google oauth api to get the user data\n\n    return await http.get(`https://www.googleapis.com/oauth2/v3/tokeninfo?id_token=` + token).then(response => {\n      //Creates the temporary User data\n      var userData = {\n        \"Email\": response.data.email,\n        \"User_FirstName\": response.data.given_name,\n        \"User_LastName\": response.data.family_name,\n        \"User_Image\": response.data.picture\n      }; //Queries the backend to search if the user exists in the database\n\n      return Barcelparts.findUser(userData).then(response => {\n        //If the user exists return the user information\n        if (response.data != null) {\n          return [true, response.data];\n        } else {\n          // If the user doesn't exist return false\n          return [false, response.data];\n        }\n      });\n    });\n  } // If there is no cookie return false\n  else {\n    return [false, undefined];\n  }\n} //Function to get cookie from its name\n\n_c = IsAuthenticated;\nexport const getCookie = () => {\n  let name = \"userGoogleId=\";\n  let token;\n  let ca = document.cookie.split(';');\n\n  for (let i = 0; i < ca.length; i++) {\n    let c = ca[i];\n\n    while (c.charAt(0) == ' ') {\n      c = c.substring(1);\n    }\n\n    if (c.indexOf(name) == 0) {\n      var separatedCookie = c.substring(name.length, c.length); //decrypt cookie\n\n      var CryptoJS = require(\"crypto-js\");\n\n      var bytes = CryptoJS.AES.decrypt(separatedCookie, 'secret key 123');\n      var decodedCookie = bytes.toString(CryptoJS.enc.Utf8);\n      token = decodedCookie;\n    }\n  }\n\n  return token;\n};\n\nvar _c;\n\n$RefreshReg$(_c, \"IsAuthenticated\");","map":{"version":3,"sources":["D:/Barcelparts/src/Services/auth.js"],"names":["Barcelparts","http","IsAuthenticated","getCookie","undefined","token","get","then","response","userData","data","email","given_name","family_name","picture","findUser","name","ca","document","cookie","split","i","length","c","charAt","substring","indexOf","separatedCookie","CryptoJS","require","bytes","AES","decrypt","decodedCookie","toString","enc","Utf8"],"mappings":"AAAA,OAAOA,WAAP,MAAwB,kBAAxB;AACA,OAAOC,IAAP,MAAiB,gBAAjB,C,CAGA;;AACA,OAAO,eAAeC,eAAf,GAAiC;AACpC;AACA,MAAIC,SAAS,MAAMC,SAAnB,EAA8B;AAC1B;AACA,QAAIC,KAAK,GAAGF,SAAS,EAArB,CAF0B,CAG1B;;AACA,WAAO,MAAMF,IAAI,CAACK,GAAL,CAAU,0DAAD,GAA6DD,KAAtE,EACRE,IADQ,CACHC,QAAQ,IAAI;AACd;AACA,UAAIC,QAAQ,GAAG;AACX,iBAASD,QAAQ,CAACE,IAAT,CAAcC,KADZ;AAEX,0BAAkBH,QAAQ,CAACE,IAAT,CAAcE,UAFrB;AAGX,yBAAiBJ,QAAQ,CAACE,IAAT,CAAcG,WAHpB;AAIX,sBAAcL,QAAQ,CAACE,IAAT,CAAcI;AAJjB,OAAf,CAFc,CAQd;;AACA,aAAOd,WAAW,CAACe,QAAZ,CAAqBN,QAArB,EACFF,IADE,CACGC,QAAQ,IAAI;AACd;AACA,YAAIA,QAAQ,CAACE,IAAT,IAAiB,IAArB,EAA2B;AACvB,iBAAO,CAAC,IAAD,EAAOF,QAAQ,CAACE,IAAhB,CAAP;AACH,SAFD,MAGK;AACD;AACA,iBAAO,CAAC,KAAD,EAAQF,QAAQ,CAACE,IAAjB,CAAP;AACH;AACJ,OAVE,CAAP;AAWH,KArBQ,CAAb;AAsBH,GA1BD,CA2BA;AA3BA,OA4BK;AACD,WAAO,CAAC,KAAD,EAAQN,SAAR,CAAP;AACH;AACJ,C,CAGD;;KApCsBF,e;AAqCtB,OAAO,MAAMC,SAAS,GAAG,MAAM;AAC3B,MAAIa,IAAI,GAAG,eAAX;AACA,MAAIX,KAAJ;AAEA,MAAIY,EAAE,GAAGC,QAAQ,CAACC,MAAT,CAAgBC,KAAhB,CAAsB,GAAtB,CAAT;;AACA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGJ,EAAE,CAACK,MAAvB,EAA+BD,CAAC,EAAhC,EAAoC;AAChC,QAAIE,CAAC,GAAGN,EAAE,CAACI,CAAD,CAAV;;AACA,WAAOE,CAAC,CAACC,MAAF,CAAS,CAAT,KAAe,GAAtB,EAA2B;AACvBD,MAAAA,CAAC,GAAGA,CAAC,CAACE,SAAF,CAAY,CAAZ,CAAJ;AACH;;AACD,QAAIF,CAAC,CAACG,OAAF,CAAUV,IAAV,KAAmB,CAAvB,EAA0B;AACtB,UAAIW,eAAe,GAAGJ,CAAC,CAACE,SAAF,CAAYT,IAAI,CAACM,MAAjB,EAAyBC,CAAC,CAACD,MAA3B,CAAtB,CADsB,CAGtB;;AACA,UAAIM,QAAQ,GAAGC,OAAO,CAAC,WAAD,CAAtB;;AACA,UAAIC,KAAK,GAAGF,QAAQ,CAACG,GAAT,CAAaC,OAAb,CAAqBL,eAArB,EAAsC,gBAAtC,CAAZ;AACA,UAAIM,aAAa,GAAGH,KAAK,CAACI,QAAN,CAAeN,QAAQ,CAACO,GAAT,CAAaC,IAA5B,CAApB;AACA/B,MAAAA,KAAK,GAAG4B,aAAR;AACH;AACJ;;AACD,SAAO5B,KAAP;AACH,CArBM","sourcesContent":["import Barcelparts from './Barcelparts.js'\r\nimport http from \"../http-common\";\r\n\r\n\r\n//Function that will verify if the user is authenticated\r\nexport async function IsAuthenticated() {\r\n    // Checks if there is a cookie with google auth token\r\n    if (getCookie() != undefined) {\r\n        //Gets the value of the cookie\r\n        let token = getCookie();\r\n        // Queries the google oauth api to get the user data\r\n        return await http.get(`https://www.googleapis.com/oauth2/v3/tokeninfo?id_token=` + token)\r\n            .then(response => {\r\n                //Creates the temporary User data\r\n                var userData = {\r\n                    \"Email\": response.data.email,\r\n                    \"User_FirstName\": response.data.given_name,\r\n                    \"User_LastName\": response.data.family_name,\r\n                    \"User_Image\": response.data.picture,\r\n                }\r\n                //Queries the backend to search if the user exists in the database\r\n                return Barcelparts.findUser(userData)\r\n                    .then(response => {\r\n                        //If the user exists return the user information\r\n                        if (response.data != null) {\r\n                            return [true, response.data]\r\n                        }\r\n                        else {\r\n                            // If the user doesn't exist return false\r\n                            return [false, response.data]\r\n                        }\r\n                    })\r\n            })\r\n    }\r\n    // If there is no cookie return false\r\n    else {\r\n        return [false, undefined]\r\n    }\r\n}\r\n\r\n\r\n//Function to get cookie from its name\r\nexport const getCookie = () => {\r\n    let name = \"userGoogleId=\";\r\n    let token;\r\n\r\n    let ca = document.cookie.split(';');\r\n    for (let i = 0; i < ca.length; i++) {\r\n        let c = ca[i];\r\n        while (c.charAt(0) == ' ') {\r\n            c = c.substring(1);\r\n        }\r\n        if (c.indexOf(name) == 0) {\r\n            var separatedCookie = c.substring(name.length, c.length)\r\n\r\n            //decrypt cookie\r\n            var CryptoJS = require(\"crypto-js\");\r\n            var bytes = CryptoJS.AES.decrypt(separatedCookie, 'secret key 123');\r\n            var decodedCookie = bytes.toString(CryptoJS.enc.Utf8);\r\n            token = decodedCookie;\r\n        }\r\n    }\r\n    return token\r\n}"]},"metadata":{},"sourceType":"module"}