{"ast":null,"code":"\"use strict\";\n\nconst {\n  utf8Encode,\n  utf8DecodeWithoutBOM\n} = require(\"./encoding\");\n\nconst {\n  percentDecodeBytes,\n  utf8PercentEncodeString,\n  isURLEncodedPercentEncode\n} = require(\"./percent-encoding\");\n\nfunction p(char) {\n  return char.codePointAt(0);\n} // https://url.spec.whatwg.org/#concept-urlencoded-parser\n\n\nfunction parseUrlencoded(input) {\n  const sequences = strictlySplitByteSequence(input, p(\"&\"));\n  const output = [];\n\n  for (const bytes of sequences) {\n    if (bytes.length === 0) {\n      continue;\n    }\n\n    let name, value;\n    const indexOfEqual = bytes.indexOf(p(\"=\"));\n\n    if (indexOfEqual >= 0) {\n      name = bytes.slice(0, indexOfEqual);\n      value = bytes.slice(indexOfEqual + 1);\n    } else {\n      name = bytes;\n      value = new Uint8Array(0);\n    }\n\n    name = replaceByteInByteSequence(name, 0x2B, 0x20);\n    value = replaceByteInByteSequence(value, 0x2B, 0x20);\n    const nameString = utf8DecodeWithoutBOM(percentDecodeBytes(name));\n    const valueString = utf8DecodeWithoutBOM(percentDecodeBytes(value));\n    output.push([nameString, valueString]);\n  }\n\n  return output;\n} // https://url.spec.whatwg.org/#concept-urlencoded-string-parser\n\n\nfunction parseUrlencodedString(input) {\n  return parseUrlencoded(utf8Encode(input));\n} // https://url.spec.whatwg.org/#concept-urlencoded-serializer\n\n\nfunction serializeUrlencoded(tuples) {\n  let encodingOverride = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;\n  let encoding = \"utf-8\";\n\n  if (encodingOverride !== undefined) {\n    // TODO \"get the output encoding\", i.e. handle encoding labels vs. names.\n    encoding = encodingOverride;\n  }\n\n  let output = \"\";\n\n  for (const [i, tuple] of tuples.entries()) {\n    // TODO: handle encoding override\n    const name = utf8PercentEncodeString(tuple[0], isURLEncodedPercentEncode, true);\n    let value = tuple[1];\n\n    if (tuple.length > 2 && tuple[2] !== undefined) {\n      if (tuple[2] === \"hidden\" && name === \"_charset_\") {\n        value = encoding;\n      } else if (tuple[2] === \"file\") {\n        // value is a File object\n        value = value.name;\n      }\n    }\n\n    value = utf8PercentEncodeString(value, isURLEncodedPercentEncode, true);\n\n    if (i !== 0) {\n      output += \"&\";\n    }\n\n    output += `${name}=${value}`;\n  }\n\n  return output;\n}\n\nfunction strictlySplitByteSequence(buf, cp) {\n  const list = [];\n  let last = 0;\n  let i = buf.indexOf(cp);\n\n  while (i >= 0) {\n    list.push(buf.slice(last, i));\n    last = i + 1;\n    i = buf.indexOf(cp, last);\n  }\n\n  if (last !== buf.length) {\n    list.push(buf.slice(last));\n  }\n\n  return list;\n}\n\nfunction replaceByteInByteSequence(buf, from, to) {\n  let i = buf.indexOf(from);\n\n  while (i >= 0) {\n    buf[i] = to;\n    i = buf.indexOf(from, i + 1);\n  }\n\n  return buf;\n}\n\nmodule.exports = {\n  parseUrlencodedString,\n  serializeUrlencoded\n};","map":{"version":3,"sources":["D:/Barcelparts/node_modules/mongodb-connection-string-url/node_modules/whatwg-url/lib/urlencoded.js"],"names":["utf8Encode","utf8DecodeWithoutBOM","require","percentDecodeBytes","utf8PercentEncodeString","isURLEncodedPercentEncode","p","char","codePointAt","parseUrlencoded","input","sequences","strictlySplitByteSequence","output","bytes","length","name","value","indexOfEqual","indexOf","slice","Uint8Array","replaceByteInByteSequence","nameString","valueString","push","parseUrlencodedString","serializeUrlencoded","tuples","encodingOverride","undefined","encoding","i","tuple","entries","buf","cp","list","last","from","to","module","exports"],"mappings":"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","sourcesContent":["\"use strict\";\r\nconst { utf8Encode, utf8DecodeWithoutBOM } = require(\"./encoding\");\r\nconst { percentDecodeBytes, utf8PercentEncodeString, isURLEncodedPercentEncode } = require(\"./percent-encoding\");\r\n\r\nfunction p(char) {\r\n  return char.codePointAt(0);\r\n}\r\n\r\n// https://url.spec.whatwg.org/#concept-urlencoded-parser\r\nfunction parseUrlencoded(input) {\r\n  const sequences = strictlySplitByteSequence(input, p(\"&\"));\r\n  const output = [];\r\n  for (const bytes of sequences) {\r\n    if (bytes.length === 0) {\r\n      continue;\r\n    }\r\n\r\n    let name, value;\r\n    const indexOfEqual = bytes.indexOf(p(\"=\"));\r\n\r\n    if (indexOfEqual >= 0) {\r\n      name = bytes.slice(0, indexOfEqual);\r\n      value = bytes.slice(indexOfEqual + 1);\r\n    } else {\r\n      name = bytes;\r\n      value = new Uint8Array(0);\r\n    }\r\n\r\n    name = replaceByteInByteSequence(name, 0x2B, 0x20);\r\n    value = replaceByteInByteSequence(value, 0x2B, 0x20);\r\n\r\n    const nameString = utf8DecodeWithoutBOM(percentDecodeBytes(name));\r\n    const valueString = utf8DecodeWithoutBOM(percentDecodeBytes(value));\r\n\r\n    output.push([nameString, valueString]);\r\n  }\r\n  return output;\r\n}\r\n\r\n// https://url.spec.whatwg.org/#concept-urlencoded-string-parser\r\nfunction parseUrlencodedString(input) {\r\n  return parseUrlencoded(utf8Encode(input));\r\n}\r\n\r\n// https://url.spec.whatwg.org/#concept-urlencoded-serializer\r\nfunction serializeUrlencoded(tuples, encodingOverride = undefined) {\r\n  let encoding = \"utf-8\";\r\n  if (encodingOverride !== undefined) {\r\n    // TODO \"get the output encoding\", i.e. handle encoding labels vs. names.\r\n    encoding = encodingOverride;\r\n  }\r\n\r\n  let output = \"\";\r\n  for (const [i, tuple] of tuples.entries()) {\r\n    // TODO: handle encoding override\r\n\r\n    const name = utf8PercentEncodeString(tuple[0], isURLEncodedPercentEncode, true);\r\n\r\n    let value = tuple[1];\r\n    if (tuple.length > 2 && tuple[2] !== undefined) {\r\n      if (tuple[2] === \"hidden\" && name === \"_charset_\") {\r\n        value = encoding;\r\n      } else if (tuple[2] === \"file\") {\r\n        // value is a File object\r\n        value = value.name;\r\n      }\r\n    }\r\n\r\n    value = utf8PercentEncodeString(value, isURLEncodedPercentEncode, true);\r\n\r\n    if (i !== 0) {\r\n      output += \"&\";\r\n    }\r\n    output += `${name}=${value}`;\r\n  }\r\n  return output;\r\n}\r\n\r\nfunction strictlySplitByteSequence(buf, cp) {\r\n  const list = [];\r\n  let last = 0;\r\n  let i = buf.indexOf(cp);\r\n  while (i >= 0) {\r\n    list.push(buf.slice(last, i));\r\n    last = i + 1;\r\n    i = buf.indexOf(cp, last);\r\n  }\r\n  if (last !== buf.length) {\r\n    list.push(buf.slice(last));\r\n  }\r\n  return list;\r\n}\r\n\r\nfunction replaceByteInByteSequence(buf, from, to) {\r\n  let i = buf.indexOf(from);\r\n  while (i >= 0) {\r\n    buf[i] = to;\r\n    i = buf.indexOf(from, i + 1);\r\n  }\r\n  return buf;\r\n}\r\n\r\nmodule.exports = {\r\n  parseUrlencodedString,\r\n  serializeUrlencoded\r\n};\r\n"]},"metadata":{},"sourceType":"script"}